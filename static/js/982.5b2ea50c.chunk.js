"use strict";(self.webpackChunkproject_eurogranite=self.webpackChunkproject_eurogranite||[]).push([[982],{3982:(e,a,l)=>{l.r(a),l.d(a,{default:()=>d});var r=l(5043),t=l(9379);const i="https://api.cloudinary.com/v1_1/".concat({NODE_ENV:"production",PUBLIC_URL:"/eurogranite-website",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CLOUDINARY_CLOUD_NAME,"/image/upload"),s=async(e,a)=>{const{category:l="driveways",graniteType:r="gabbro",year:t=(new Date).getFullYear(),size:s="medium",location:n="",description:o=""}=a,c=Date.now(),d="eurogranite/gallery/".concat(l,"/").concat(l,"-").concat(c),p=["gallery",l,r,t.toString(),s,"granite-paving"].filter(Boolean),g=new FormData;g.append("file",e),g.append("public_id",d),g.append("upload_preset",{NODE_ENV:"production",PUBLIC_URL:"/eurogranite-website",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_CLOUDINARY_UPLOAD_PRESET),g.append("tags",p.join(",")),g.append("folder","eurogranite/gallery/".concat(l));const u={category:l,graniteType:r,year:t.toString(),size:s,location:n,description:o,uploadDate:(new Date).toISOString()};g.append("context",Object.entries(u).map(e=>{let[a,l]=e;return"".concat(a,"=").concat(l)}).join("|"));try{const e=await fetch(i,{method:"POST",body:g});if(!e.ok)throw new Error("Upload failed: ".concat(e.statusText));const a=await e.json();return console.log("\u2705 Image uploaded successfully:",a.public_id),a}catch(m){throw console.error("\u274c Upload error:",m),m}};var n=l(7380),o=l(579);const c=e=>{let{onUploadComplete:a}=e;const[l,i]=(0,r.useState)([]),[c,d]=(0,r.useState)(!1),[p,g]=(0,r.useState)(null),[u,m]=(0,r.useState)([]),h=(0,r.useCallback)(e=>{const a=Array.from(e.target.files),l=[];a.forEach(e=>{const a=(e=>{const a=[];return e.size>10485760&&a.push("File size (".concat(Math.round(e.size/1024/1024),"MB) exceeds 10MB limit")),["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type)||a.push("File type ".concat(e.type," not supported. Use JPG, PNG, or WebP")),{isValid:0===a.length,errors:a}})(e);if(a.isValid){const a=(e=>{const a=e.toLowerCase().replace(/\.(jpg|jpeg|png|webp)$/i,"").split("-"),l={category:"driveways",graniteType:"gabbro",size:"medium",year:(new Date).getFullYear(),location:""},r=["driveway","walkway","plaza","courtyard"].find(e=>a[0]&&a[0].includes(e));r&&(l.category=r.endsWith("s")?r:"".concat(r,"s"));const t=["gabbro","black","grey","gray","red","brown","green","labradorite"].find(e=>a.includes(e));t&&("black"===t||"gabbro"===t?l.graniteType="gabbro":"grey"===t||"gray"===t?l.graniteType="real-grey":"red"===t||"brown"===t?l.graniteType="rosso-santiago":"green"===t?l.graniteType="verde-oliva":"labradorite"===t&&(l.graniteType="ukrainian-labradorite-volga-blue"));const i=["small","medium","large"].find(e=>a.includes(e));i&&(l.size=i);const s=a.find(e=>/^\d{4}$/.test(e));s&&(l.year=parseInt(s));const n=["kyiv","lviv","kharkiv","odesa","dnipro"].find(e=>a.includes(e));return n&&(l.location=n.charAt(0).toUpperCase()+n.slice(1)),l})(e.name);l.push({file:e,metadata:a,preview:URL.createObjectURL(e),id:Math.random().toString(36).substr(2,9)})}else console.warn("Invalid file ".concat(e.name,":"),a.errors)}),i(e=>[...e,...l])},[]),j=(0,r.useCallback)((e,a,l)=>{i(r=>r.map(r=>r.id===e?(0,t.A)((0,t.A)({},r),{},{metadata:(0,t.A)((0,t.A)({},r.metadata),{},{[a]:l})}):r))},[]),y=(0,r.useCallback)(e=>{i(a=>{const l=a.find(a=>a.id===e);return null!==l&&void 0!==l&&l.preview&&URL.revokeObjectURL(l.preview),a.filter(a=>a.id!==e)})},[]);return(0,o.jsxs)("div",{className:"image-uploader",children:[(0,o.jsxs)("div",{className:"upload-controls",children:[(0,o.jsx)("input",{type:"file",multiple:!0,accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:h,disabled:c,className:"file-input"}),l.length>0&&(0,o.jsx)("button",{onClick:async()=>{if(0!==l.length){d(!0),g({current:0,total:l.length,percentage:0});try{const e=l.map(e=>({file:e.file,metadata:e.metadata})),r=await(async(e,a)=>{const l=[],r=e.length;for(let i=0;i<e.length;i++){const{file:n,metadata:o}=e[i];try{const e=await s(n,o);l.push({success:!0,result:e}),a&&a({current:i+1,total:r,percentage:Math.round((i+1)/r*100),currentFile:n.name})}catch(t){l.push({success:!1,error:t,fileName:n.name})}}return l})(e,g);m(r);const t=r.filter(e=>e.success).length;console.log("\u2705 Upload complete: ".concat(t,"/").concat(l.length," files uploaded successfully")),a&&a(r);const n=r.map((e,a)=>e.success?null:l[a].id).filter(Boolean);i(e=>e.filter(e=>n.includes(e.id)))}catch(e){console.error("Upload failed:",e)}finally{d(!1)}}},disabled:c,className:"upload-button",children:c?"Uploading...":"Upload ".concat(l.length," image(s)")})]}),p&&(0,o.jsxs)("div",{className:"upload-progress",children:[(0,o.jsx)("div",{className:"progress-bar",children:(0,o.jsx)("div",{className:"progress-fill",style:{width:"".concat(p.percentage,"%")}})}),(0,o.jsxs)("span",{children:[p.current,"/",p.total," (",p.percentage,"%)"]}),p.currentFile&&(0,o.jsxs)("span",{children:["Uploading: ",p.currentFile]})]}),l.length>0&&(0,o.jsx)("div",{className:"files-preview",children:l.map(e=>(0,o.jsxs)("div",{className:"file-preview-card",children:[(0,o.jsx)("img",{src:e.preview,alt:e.file.name,className:"preview-image"}),(0,o.jsxs)("div",{className:"file-metadata",children:[(0,o.jsx)("h4",{children:e.file.name}),(0,o.jsxs)("div",{className:"metadata-field",children:[(0,o.jsx)("label",{children:"Category:"}),(0,o.jsx)("select",{value:e.metadata.category,onChange:a=>j(e.id,"category",a.target.value),children:n.eP.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name.en},e.id))})]}),(0,o.jsxs)("div",{className:"metadata-field",children:[(0,o.jsx)("label",{children:"Additional Notes (optional):"}),(0,o.jsx)("input",{type:"text",placeholder:"Optional description or notes",value:e.metadata.notes||"",onChange:a=>j(e.id,"notes",a.target.value)})]}),(0,o.jsxs)("div",{className:"metadata-field",children:[(0,o.jsx)("label",{children:"Year:"}),(0,o.jsx)("input",{type:"number",min:"2020",max:(new Date).getFullYear()+1,value:e.metadata.year,onChange:a=>j(e.id,"year",parseInt(a.target.value))})]}),(0,o.jsxs)("div",{className:"metadata-field",children:[(0,o.jsx)("label",{children:"Location:"}),(0,o.jsx)("input",{type:"text",value:e.metadata.location,onChange:a=>j(e.id,"location",a.target.value),placeholder:"e.g., Kyiv"})]}),(0,o.jsx)("button",{onClick:()=>y(e.id),className:"remove-button",disabled:c,children:"Remove"})]})]},e.id))}),u.length>0&&(0,o.jsxs)("div",{className:"upload-results",children:[(0,o.jsx)("h3",{children:"Upload Results:"}),u.map((e,a)=>(0,o.jsx)("div",{className:"result-item ".concat(e.success?"success":"error"),children:e.success?(0,o.jsxs)("span",{children:["\u2705 ",e.result.public_id]}):(0,o.jsxs)("span",{children:["\u274c ",e.fileName,": ",e.error.message]})},a))]})]})},d=()=>(0,o.jsx)("div",{className:"admin-upload-page",children:(0,o.jsxs)("div",{className:"container",style:{maxWidth:"1200px",margin:"2rem auto",padding:"0 1rem"},children:[(0,o.jsx)("h1",{style:{textAlign:"center",marginBottom:"2rem",color:"#1f2937"},children:"EuroGranite Gallery Image Upload"}),(0,o.jsxs)("div",{style:{background:"#f0f9ff",padding:"1rem",borderRadius:"0.5rem",marginBottom:"2rem",border:"1px solid #bfdbfe"},children:[(0,o.jsx)("h3",{style:{margin:"0 0 0.5rem 0",color:"#1e40af"},children:"\ud83d\udcc1 \u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0456\u0457 \u043f\u043e \u0456\u043c\u0435\u043d\u0443\u0432\u0430\u043d\u043d\u044e \u0444\u0430\u0439\u043b\u0456\u0432:"}),(0,o.jsxs)("ul",{style:{margin:0,paddingLeft:"1.5rem",color:"#1e40af"},children:[(0,o.jsx)("li",{children:(0,o.jsx)("code",{children:"black-granite-driveway-large-2024-kyiv.jpg"})}),(0,o.jsx)("li",{children:(0,o.jsx)("code",{children:"grey-granite-walkway-medium-2023.png"})}),(0,o.jsx)("li",{children:(0,o.jsx)("code",{children:"labradorite-plaza-large-2024-lviv.webp"})})]}),(0,o.jsx)("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.875rem",color:"#3730a3"},children:"\u0421\u0438\u0441\u0442\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u043d\u043e \u0440\u043e\u0437\u043f\u0456\u0437\u043d\u0430\u0454 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0456\u044e, \u0442\u0438\u043f \u0433\u0440\u0430\u043d\u0456\u0442\u0443, \u0440\u043e\u0437\u043c\u0456\u0440 \u0442\u0430 \u0456\u043d\u0448\u0456 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0438 \u0437 \u043d\u0430\u0437\u0432\u0438 \u0444\u0430\u0439\u043b\u0443."})]}),(0,o.jsx)(c,{onUploadComplete:e=>{console.log("Upload completed:",e);const a=e.filter(e=>e.success);a.length>0&&(console.log("\u2705 Successfully uploaded images:"),a.forEach(e=>{var a;console.log("- ".concat(e.result.public_id)),console.log("  URL: ".concat(e.result.secure_url)),console.log("  Tags: ".concat(null===(a=e.result.tags)||void 0===a?void 0:a.join(", ")))}))}}),(0,o.jsxs)("div",{style:{background:"#f0fdf4",padding:"1rem",borderRadius:"0.5rem",marginTop:"2rem",border:"1px solid #bbf7d0"},children:[(0,o.jsx)("h3",{style:{margin:"0 0 0.5rem 0",color:"#166534"},children:"\ud83d\udd27 \u041d\u0430\u0441\u0442\u0443\u043f\u043d\u0456 \u043a\u0440\u043e\u043a\u0438:"}),(0,o.jsxs)("ol",{style:{margin:0,paddingLeft:"1.5rem",color:"#166534"},children:[(0,o.jsx)("li",{children:"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0442\u0435 \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f \u0447\u0435\u0440\u0435\u0437 \u0444\u043e\u0440\u043c\u0443 \u0432\u0438\u0449\u0435"}),(0,o.jsx)("li",{children:"\u041f\u0435\u0440\u0435\u0432\u0456\u0440\u0442\u0435 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u0456 \u043a\u043e\u0436\u043d\u043e\u0433\u043e \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u043d\u044f"}),(0,o.jsx)("li",{children:'\u041d\u0430\u0442\u0438\u0441\u043d\u0456\u0442\u044c "Upload" \u0434\u043b\u044f \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0432 Cloudinary'}),(0,o.jsx)("li",{children:"\u0421\u043a\u043e\u043f\u0456\u044e\u0439\u0442\u0435 public_id \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u0438\u0445 \u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u044c"}),(0,o.jsxs)("li",{children:["\u0414\u043e\u0434\u0430\u0439\u0442\u0435 \u0457\u0445 \u0434\u043e ",(0,o.jsx)("code",{children:"galleryData.js"})]})]})]})]})})}}]);
//# sourceMappingURL=982.5b2ea50c.chunk.js.map